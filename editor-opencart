<!DOCTYPE html>
<html lang="en">
<meta content="light dark" name="color-scheme" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0" />
<style>
body {
  font-family: Arial, sans-serif;
  font-size: 1rem;
  font-weight: 500;
  max-width: 100%;
  margin: 0;
  padding: 0;
  position: relative;
  width: inherit;
}
.results {
  max-width: calc(80vw - 120px);
  min-height: 300px;
  margin: auto;
  margin-top: 2rem;
  border: none;
  background: #0088ff08;
  padding: 1rem;
  color: inherit;
  width: 100%;
  font-size: inherit;
}
:root {--color-white: light-dark(#fff, #555);--color-black: light-dark(#000, #fff);--link: light-dark(blue, cyan);--fontsize: 1.05rem;--menuWidth: 100px;}.editor {position: relative;width: inherit;padding: 5rem .5rem 3rem 180px;border: solid 1px #ccc;border-radius: 1rem;box-shadow: 1px 3px 5px #cccccc63;background: var(--color-white);height: 100%;overflow: auto;font-size: var(--fontsize);}.editor .bottombar {display: flex;gap: .25rem;margin-top: 3rem;flex-wrap: wrap;}.editor button {display: inline-block;border-radius: 0;font-size: var(--fontsize);}.blocks .menuOnOff {position: absolute;border: none;right: calc(100% + 1rem);top: 26px;background: var(--color-black);width: var(--menuWidth);display: inline-block;text-overflow: ellipsis;overflow: hidden;white-space: nowrap;align-items: center;justify-content: end;color: var(--color-white);font-size: 1rem;padding: .25rem .5rem;}.editor .bottombar > button {background: var(--color-black);color: var(--color-white);border: none;display: inline-flex;width: 36px;height: 36px;font-size: 1.5rem;justify-content: center;align-items: center;cursor: pointer;user-select: none;font-family: inherit;}.editor button.generate, .editor button.addImg, .editor button.addVideo, .editor button.addTable {width: fit-content;padding: .5rem .75rem;font-size: 1.1rem;line-height: 1;}.editor .block {position: relative;background-color: #f0f0f02e;margin: 1rem 0;position: relative;white-space: pre-wrap;user-select: text;-webkit-user-select: text;}.editor .tempblock {position: relative;padding: 5px 0 48px 0;}.editor .tempblock figure:has(figcaption)+.menu>.imgAdd,.editor .tempblock figure:not(:has(figcaption))+.menu>.imgRemove,.tempblock>div:has(table):has(caption)+.menu .addCaption,.tempblock>div:has(table):not(:has(caption))+.menu .removeCaption{display:none}.editor ul.menu {list-style: none;display: none;position: absolute;width: max-content;right: calc(100% + 10px);top: 0;background-color: var(--color-white);margin: 0;padding: .25rem;user-select: none;z-index: 1;box-shadow: 1px 1px 5px #ccc;height: 200px;overflow-x: auto;scrollbar-width: thin;text-wrap: nowrap;}.editor .menu > button.removeBlock {background: red;color: #fff;}.editor .menu > button {cursor: pointer;margin: 2px;user-select: none;padding: .25em 1em;border-radius: 0;background: var(--color-white);width: 100%;display: block;font-size: 1rem;font-family: inherit;font-weight: bold;font-stretch: expanded;text-align: left;color: inherit;line-height: 1.5;border: none;letter-spacing: -.3px;}.editor .menu>button[disabled]{cursor:not-allowed;opacity:.5}.editor div:first-child button.moveUp, .editor div:last-child button.moveDown {background: #ccc;pointer-events: none;}@media (orientation: landscape) {.editor .tempblock:not(:has(.block:focus)):hover ul.menu {display:block;}}.editor button:hover {opacity: .5;}.editor ul.block li, ol.block li {line-height: 1.5;inset: 0;margin-left: 1rem;}h1,h2,h3,h4,h5,h6,p,ul,ol,div{position:relative;}.editor h1 {font-size: 2rem;line-height: 1.3;letter-spacing: -1px;}.editor h2 {font-size: 1.8rem;line-height: 1.3;letter-spacing: -1px;}.editor h3 {font-size: 1.7rem;line-height: 1.3;letter-spacing: -1px;}.editor h4 {font-size: 1.5rem;line-height: 1.2;}.editor h5 {font-size: 1.3rem;line-height: 1.2;}.editor h6 {font-size: 1.1rem;line-height: 1.2;}.editor p, .editor ul, .editor ol {line-height: 1.8;}.block::selection {color: red;background-color: yellow;}@media (orientation: portrait) {.editor {max-width: 100%;margin: auto;padding: 3rem 1rem;}.editor ul.menu {top: calc(100% - 45px);left: 0;}.editor .menu button {font-size: 1.1rem;}.editor .toolbar {width:100%;overflow:auto}.blocks figure.block::before, .blocks h1.block::before, .blocks h2.block::before, .blocks h3.block::before, .blocks h4.block::before, .blocks h5.block::before, .blocks h6.block::before, .blocks p.block::before, .blocks ul.block::before, .blocks ol.block::before, .blocks div.block::before {top: -26px;left: 0;}.editor .topMenu {left: var(--menuWidth);width: calc(100% - var(--menuWidth)) !important;}.editor .topMenu::before {max-width: 100%;}.toolbar {left: 0 !important;}.blocks .menuOnOff {left: 0;top: -16px !important;cursor: pointer;justify-content: center;}.editor .tempblock:not(:has(.block:focus)):hover ul.menu, .editor .tempblock:not(:has(.block:focus)):hover .topMenu {//display: none !important;}}.editor .toolbar {position: absolute;background: var(--color-white);padding: 0;z-index: 1000;border: solid 1px;box-shadow: 1px 1px 3px #8c8c8c;display: none;margin: 0;color: var(--color-black);}.editor .toolbar.active {display: flex;}.toolbar > button, .toolbar > select {margin: 0;padding: .75rem;border: none;border-right-width: medium;border-right-style: none;border-right-color: currentcolor;background: transparent;border-right: solid 1px;border-bottom: solid 1px;cursor: pointer;font-size: 1rem;font-family: inherit;}.editor .block a {color: var(--link);cursor: pointer;}.editor .topMenu {display: none;margin: 0;padding: 0;position: absolute;z-index: 1;width: 100%;text-align: right;top: -24px;}.editor .menu.active, .editor .topMenu.active {display: block !important;;}.editor .topMenu > button:hover {background: var(--color-black);color: var(--color-white);}.editor .topMenu::before {content: "";display: block;width: 100%;background: #000;height: 1px;margin-top: 18px;position: absolute;z-index: -1;}.editor .topMenu > button {font-size: 1rem;font-family: inherit;cursor: pointer;margin: 0;padding: .5rem .5rem;background: var(--color-white);color: var(--color-black);border-top: solid 1px;border-left: solid 1px;border-bottom: solid 1px;border-right: none;border-radius: 0;letter-spacing: -.3px;}.editor .topMenu > button:last-child {border-right: solid 1px;}.editor .topMenu button:hover {opacity: 1;}@media (orientation: landscape) {.editor .tempblock:not(:has(.block:focus)):hover .topMenu {display: block;}}.editor [contenteditable]:empty::after {content: attr(data-placeholder);color: grey;display: inline-block;}.editor div:has(table) {width: 100%;}.editor div > table {border-collapse: collapse;width: 100%;}.editor div > table th, td {text-align: left;padding: 8px;}.editor div > table tr:nth-child(even) {background-color: #cecece36;}.editor div > table > caption {padding: .5rem 0;font-weight: bold;line-height: 1.5;}.editor figcaption {padding: .25rem 0;font-style: italic;line-height: 1.5;}.editor .saved-item {display: flex;gap: 1rem;padding: .5rem 1rem;background: #ff000008;color: red;align-items: center;margin-bottom: 2rem;flex-wrap: wrap;}.editor .saved-item > button {font-size: inherit;border: solid 1px;background: none;font-weight: bold;cursor: pointer;color: red;display: flex;align-content: center;}.editor strong, .editor q, .editor mark, .editor del,.editor b, .editor italic, .editor u, .editor a, .editor code, .editor i, .editor figcaption {-webkit-user-select: all;-moz-user-select: all;-ms-user-select: all;user-select: all;}.fullscreen {background: none;border: none;position: absolute;top: 1rem;right: 1rem;cursor: pointer;user-select: none;padding: 0;font-size: 1rem;}button.delButton {text-decoration-line: line-through;}button.boldButton {font-weight: bolder;}button.italicButton {font-style: italic;}button.underlineButton {text-decoration: underline;}[contenteditable="true"] a::after {content: " [" attr(target) "]";color: inherit;text-decoration: none;font-size: 80%;vertical-align: super;position: relative;display: inline-block;}
</style>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patrick Chia Block-Based Editor</title>
</head>
<body tabindex="0">
		
		
    <div id="editor" class="editor">
		<button type="button" class="fullscreen" data-editor="">Fullscreen</button>
	
		<div id="blocks" class="blocks"></div>
        <div class="bottombar">
			<button type="button" data-editor="editor" class="addBlock">+</button>
			<button type="button" data-editor="editor" class="addImg">+Image</button>
			<button type="button" data-editor="editor" class="addVideo">+Video</button>
			<button type="button" data-editor="editor" class="addTable">+Table</button>
			<button type="button" data-editor="editor" data-box="results" class="generate">Generate</button>
		</div>
			<textarea id="results" class="results" data-editor="editor">&lt;h1&gt;HTML Headings H1&lt;/h1&gt;&lt;h2&gt;HTML Headings H2&lt;/h2&gt;&lt;h3&gt;HTML Headings H3&lt;/h3&gt;&lt;h4&gt;HTML Headings H4&lt;/h4&gt;&lt;h5&gt;HTML Headings H5&lt;/h5&gt;&lt;h6&gt;HTML Headings H6&lt;/h6&gt;&lt;ul&gt;&lt;li&gt;What Does UL Listed Mean?&lt;/li&gt;&lt;li&gt;The UL Listed Mark is a tier of UL approval for stand-alone consumables that have undergone rigorous testing by Underwriters Laboratories.&lt;/li&gt;&lt;li&gt;Meets nationally recognized standards for sustainability and safety.&lt;/li&gt;&lt;/ul&gt;&lt;ol&gt;&lt;li&gt;HTML element represents an ordered list of items&lt;/li&gt;&lt;li&gt;Typically rendered as a numbered list.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;A subdivision of a written composition that consists of one or more sentences, deals with one point or gives the words of one speaker, and begins on a new usually indented line.&lt;/p&gt;&lt;blockquote&gt;A &lt;strong&gt;block quote&lt;/strong&gt; is a long &lt;a href=&quot;https://www.w3schools.com/html/html_quotation_elements.asp&quot; target=&quot;_self&quot; rel=&quot;noopener&quot;&gt;quote formatted&lt;/a&gt; as a separate &lt;q&gt;block&lt;/q&gt; of text. Instead of using &lt;mark&gt;quotation marks&lt;/mark&gt;, you place the quote on a &lt;del&gt;new line&lt;/del&gt;, and indent the entire quote to mark it apart from your own words.&lt;/blockquote&gt;</textarea>

		</div>


<script type="text/javascript">
'use strict';
/*!
 * Block Based Editor for OpenCart
 * https://chiaseek.com/
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license
 *
 * Date: 2024-12-01T13:37
 */ 
const editors=document.querySelectorAll(".editor");for(let e=0;e<editors.length;e++){const t=editors[e].id;document.querySelector("#"+t+" .generate").addEventListener("click",generate),document.querySelector("#"+t+" .addImg").addEventListener("click",(()=>addImageBlock(t,!1))),document.querySelector("#"+t+" .addVideo").addEventListener("click",(()=>addVideoBlock(t,!1))),document.querySelector("#"+t+" .addBlock").addEventListener("click",(()=>addBlock(t,!1))),document.querySelector("#"+t+" .addTable").addEventListener("click",(()=>addTable(t,!1)));const n=document.querySelector("#"+t);n.addEventListener("click",(e=>{e.preventDefault();const o=e.target.getAttribute("data-block"),a=document.getElementById("TB"+o);if(e.target.classList.contains("removeBlock")){if(""!==document.getElementById(o).innerText.trim()){return void(confirm("Are you sure you want to delete this block?")&&a.remove())}a.remove()}const l=document.querySelector("#"+t+" .blocks");if(e.target.classList.contains("moveUp")){const t=e.target.closest(".tempblock");t&&t.previousElementSibling&&l.insertBefore(t,t.previousElementSibling)}if(e.target.classList.contains("moveDown")){const t=e.target.closest(".tempblock");t&&t.nextElementSibling&&l.insertBefore(t.nextElementSibling,t)}if(e.target.classList.contains("menuOnOff")){e.preventDefault();const t=document.querySelectorAll(".toolbar");for(let e=0;e<t.length;e++){t[e].classList.remove("active")}const n=document.querySelector("#MN"+o),a=document.querySelector("#TM"+o);n.classList.contains("active")?(n.classList.remove("active"),a.classList.remove("active")):(n.classList.add("active"),a.classList.add("active"))}n.addEventListener("click",(e=>closeMenu(e)));const r={h1:()=>convertToTag(t,o,"h1"),h2:()=>convertToTag(t,o,"h2"),h3:()=>convertToTag(t,o,"h3"),h4:()=>convertToTag(t,o,"h4"),h5:()=>convertToTag(t,o,"h5"),h6:()=>convertToTag(t,o,"h6"),div:()=>convertToTag(t,o,"div"),blockquote:()=>convertToTag(t,o,"blockquote"),p:()=>convertToTag(t,o,"p"),ol:()=>convertToTag(t,o,"ol"),ul:()=>convertToTag(t,o,"ul"),addBtnBlock:()=>addBlock(t,o),addImageBlock:()=>addImageBlock(t,o),imgAlt:()=>imageOption(o,"alt"),imgUpload:()=>imageUpload(o),imgURL:()=>imageOption(o,"link"),imgWidth:()=>imageOption(o,"width"),imgHeight:()=>imageOption(o,"height"),imgRemove:()=>imageOption(o,"removeCaption"),imgAdd:()=>imageOption(o,"addCaption"),embedURL:()=>embedOption(o,"link"),embedWidth:()=>embedOption(o,"width"),embedHeight:()=>embedOption(o,"height"),removeCaption:()=>tableOption(o,"removeCaption"),addCaption:()=>tableOption(o,"addCaption"),addRow:()=>tableOption(o,"addRow"),removeRow:()=>tableOption(o,"removeRow"),addCol:()=>tableOption(o,"addColumn"),removeCol:()=>tableOption(o,"removeColumn")};for(const[t,n]of Object.entries(r))if(e.target.classList.contains(t)){n();break}if(e.target.classList.contains("tempblock")||e.target.classList.contains("editor")){const e=document.querySelectorAll(".toolbar");for(let t=0;t<e.length;t++)e[t].classList.remove("active")}})),n.addEventListener("focus",(e=>{if(e.target.matches('[contenteditable="true"]')){const t=e.target.id||e.target.dataset.block,n=document.getElementById("TBAR"+t),o=document.querySelectorAll(".toolbar");for(let e=0;e<o.length;e++)o[e].classList.remove("active");n.classList.add("active")}}),!0);const o=()=>{document.fullscreenElement?(document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen(),l.textContent="Fullscreen"):(n.requestFullscreen?n.requestFullscreen():n.mozRequestFullScreen?n.mozRequestFullScreen():n.webkitRequestFullscreen?n.webkitRequestFullscreen():n.msRequestFullscreen&&n.msRequestFullscreen(),l.textContent="Exit Fullscreen")},a=()=>{document.fullscreenElement?l.textContent="Exit Fullscreen":l.textContent="Fullscreen"},l=document.querySelector("#"+t+" .fullscreen");l.addEventListener("click",o),document.addEventListener("fullscreenchange",a),document.addEventListener("mozfullscreenchange",a),document.addEventListener("webkitfullscreenchange",a),document.addEventListener("msfullscreenchange",a);const r=e=>{const t=document.createElement("div");t.id="saveItem"+e,t.classList.add("saved-item");for(let n=0;n<localStorage.length;n++)if(localStorage.key(n)===e){const n=localStorage.getItem(e+"-date");t.textContent=n?"Found Saved: Draft "+n:"Found Saved: Draft ";const o=document.createElement("button");o.dataset.editor=e,o.type="button",o.textContent="Restored";const a=document.createElement("button");a.type="button",a.dataset.editor=e,a.textContent="Clear",a.addEventListener("click",(()=>{const e=a.dataset.editor;localStore.clear(e),localStore.clear(e+"-date"),document.getElementById("saveItem"+e).remove()})),o.addEventListener("click",(()=>{const e=o.dataset.editor,t=localStorage.getItem(e);if(t){const n=document.querySelector("#"+e+" .results");document.getElementById(n.id).innerHTML=restoreAngleBrackets(t),processContent(e,n.id),document.getElementById("saveItemeditor").textContent="Restored Done."}})),t.appendChild(o),t.appendChild(a),document.querySelector("#"+e+" .blocks").insertAdjacentElement("beforebegin",t)}};document.addEventListener("DOMContentLoaded",(()=>{r(t)}))}const keyboardSupport=(e,t)=>{e.addEventListener("keydown",(n=>{if("Enter"===n.key&&(n.preventDefault(),addBlock(t,!1),e.blur()),"Delete"===n.key||"Backspace"===n.key){const t=e.querySelector("br");e.innerText.trim();document.execCommand("insertHTML",!1,""),t&&(n.preventDefault(),t.remove())}})),e.addEventListener("paste",(e=>{e.preventDefault();const t=(e.clipboardData||window.clipboardData).getData("text/plain");document.execCommand("insertHTML",!1,""),document.execCommand("insertText",!1,t.replace(/<br[^>]*>/g,"*").replace(/[\r\n]+/g,"**"))}))},closeMenu=e=>{e.preventDefault();const t=document.querySelectorAll(".menu"),n=document.querySelectorAll(".topMenu"),o=document.querySelectorAll(".menuOnOff");for(let a=0;a<t.length;a++){const l=t[a];l.classList.contains("active")&&(l.contains(e.target)||o[a].contains(e.target)||(l.classList.remove("active"),n[a].classList.remove("active")))}},addTable=(e,t)=>{const n=prompt("Enter Number Rows:",5),o=prompt("Enter Number Columns:",4),a=document.querySelector("#"+e+" .blocks"),l=document.createElement("div");l.setAttribute("tabindex","0"),l.id=Date.now()%1e4,l.className="block",n>0&&o>0?createTable(l,n,o):createTable(l,5,4);const r=createMenuList(l.id,l,"table");if(t>0){const e=document.getElementById("TB"+t);e&&e.insertAdjacentElement("beforebegin",r)}else a.appendChild(r);l.querySelector("caption").focus(),inlineTool(e,l.id)},createTable=(e,t,n)=>{const o=e;if(!o)return void console.error("Container not found");const a=document.createElement("table");a.id="table"+e.id;const l=document.createElement("caption");l.setAttribute("data-placeholder","Table Caption"),l.setAttribute("contenteditable","true"),l.dataset.block=e.id,a.appendChild(l);for(let o=0;o<t;o++){const t=document.createElement("tr");for(let a=0;a<n;a++){const n=document.createElement("td");n.setAttribute("contenteditable","true"),n.dataset.block=e.id,n.textContent=`Row ${o+1}, Col ${a+1}`,t.appendChild(n)}a.appendChild(t)}o.appendChild(a)},addImageBlock=(e,t)=>{const n=document.querySelector("#"+e+" .blocks"),o=document.createElement("figure");o.setAttribute("tabindex","0"),o.id=Date.now()%1e4,o.className="block";const a=document.createElement("picture");a.innerHTML='<img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTuv7GqevqRqUgCNaskcs87rvMxqN-jENlxNQ&s" alt="" />',o.appendChild(a);const l=document.createElement("figcaption");l.setAttribute("contenteditable","true"),l.dataset.block=o.id,l.setAttribute("data-placeholder","Image Description"),o.appendChild(l),keyboardSupport(o,e);const r=createMenuList(o.id,o,"image");if(t>0){const e=document.getElementById("TB"+t);e&&e.insertAdjacentElement("beforebegin",r)}else n.appendChild(r);l.focus(),inlineTool(e,o.id)},addVideoBlock=(e,t)=>{const n=document.querySelector("#"+e+" .blocks"),o=document.createElement("embed");o.setAttribute("tabindex","0"),o.id=Date.now()%1e4,o.className="block",o.width="315",o.height="560",o.src="https://www.youtube.com/embed/5ncnsuNm-6A?si=0FUJ5K2LWydm_7oa",keyboardSupport(o,e);const a=createMenuList(o.id,o,"embed");if(t>0){const e=document.getElementById("TB"+t);e&&e.insertAdjacentElement("beforebegin",a)}else n.appendChild(a)},addBlock=(e,t)=>{const n=document.querySelector("#"+e+" .blocks"),o=document.createElement("p");o.setAttribute("contenteditable","true"),o.setAttribute("tabindex","0"),o.setAttribute("data-placeholder","Type something..."),o.id=Date.now()%1e4,o.className="block",keyboardSupport(o,e);const a=createMenuList(o.id,o,"general");if(t>0){const e=document.getElementById("TB"+t);e&&e.insertAdjacentElement("beforebegin",a)}else n.appendChild(a);o.focus(),inlineTool(e,o.id)},createMenuList=(e,t,n)=>{const o=document.createElement("div");o.dataset.block=t.id,o.id="TB"+e,o.className="tempblock";const a=document.createElement("button");a.className="menuOnOff",a.dataset.block=t.id,a.innerText="table"===n?"TABLE":t.tagName,o.appendChild(a);const l=document.createElement("div");l.className="topMenu",l.id="TM"+t.id;const r=document.createElement("button");r.className="addBtnBlock",r.dataset.block=t.id,r.textContent="+Block";const c=document.createElement("button");c.className="addImageBlock",c.dataset.block=t.id,c.textContent="+Image";const i=document.createElement("button");i.className="moveUp",i.dataset.block=t.id,i.textContent="Up";const d=document.createElement("button");d.className="moveDown",d.dataset.block=t.id,d.textContent="Down",l.appendChild(r),l.appendChild(c),l.appendChild(i),l.appendChild(d),o.appendChild(l);const s=document.createElement("ul");let m;s.className="menu",s.id="MN"+t.id,s.dataset.block=t.id,m="image"===n?[{className:"removeBlock",text:"Remove Image"},{className:"imgUpload",text:"Upload Image"},{className:"imgURL",text:"Image URL"},{className:"imgRemove",text:"Remove Caption"},{className:"imgAdd",text:"Add Caption"},{className:"imgWidth",text:"Image Width"},{className:"imgHeight",text:"Image Height"},{className:"imgAlt",text:"Alt"}]:"embed"===n?[{className:"removeBlock",text:"Remove Embed"},{className:"embedURL",text:"Embed URL"},{className:"embedWidth",text:"Width"},{className:"embedHeight",text:"Height"}]:"table"===n?[{className:"removeBlock",text:"Remove Table"},{className:"removeCaption",text:"Remove Caption"},{className:"addCaption",text:"Add Caption"},{className:"addRow",text:"Add Row"},{className:"removeRow",text:"Remove Row"},{className:"addCol",text:"Add Column"},{className:"removeCol",text:"Remove Column"}]:[{className:"removeBlock",text:"Remove"},{className:"p",text:"Paragraph"},{className:"div",text:"DIV"},{className:"h1",text:"H1 Heading"},{className:"h2",text:"H2 Heading"},{className:"h3",text:"H3 Heading"},{className:"h4",text:"H4 Heading"},{className:"h5",text:"H5 Heading"},{className:"h6",text:"H6 Heading"},{className:"ul",text:"UL List"},{className:"ol",text:"OL List"},{className:"blockquote",text:"Blockquote"}];for(let e=0;e<m.length;e++){const{className:n,text:o}=m[e],a=document.createElement("button");a.type="button",a.dataset.block=t.id,a.className=n,a.textContent=o,t.tagName.toLowerCase()===n&&(a.disabled=!0),s.appendChild(a)}return o.appendChild(t),o.appendChild(s),o.appendChild(inlineToolbar(t.id)),o},inlineToolbar=e=>{const t=document.createElement("div");t.className="toolbar",t.id="TBAR"+e,t.dataset.block=e;const n=[{className:"removeFormattingButton",text:"X",title:"Remove formmatting or close"},{className:"boldButton",text:"B",title:"Bold Selected Text"},{className:"italicButton",text:"I",title:"Italic text"},{className:"underlineButton",text:"U",title:"Underline Selected Text"},{className:"quoteButton",text:'"',title:"Insert quotation marks"},{className:"markButton",text:"Mark",title:"Marked text"},{className:"delButton",text:"del",title:"Deleted text"},{className:"codeButton",text:"Code",title:"Change Selected Text to Code"},{className:"insertLink",text:"+Link",title:"Insert Link"}];for(let o=0;o<n.length;o++){const a=n[o],l=document.createElement("button");l.type="button",l.className=a.className,l.title=a.title,l.dataset.block=e,l.innerHTML=a.text,t.appendChild(l)}const o=document.createElement("select");o.className="linkTarget";const a=[{value:"_self",text:"_self"},{value:"_blank",text:"_blank"},{value:"_parent",text:"_parent"},{value:"_top",text:"_top"}];for(let e=0;e<a.length;e++){const t=a[e],n=document.createElement("option");n.value=t.value,n.textContent=t.text,o.appendChild(n)}return t.appendChild(o),t},removeEmptyAttributes=()=>{document.querySelectorAll("*").forEach((e=>{Array.from(e.attributes).forEach((t=>{""===t.value&&e.removeAttribute(t.name)}))}))};function generate(){const e=this.getAttribute("data-box"),t=this.getAttribute("data-editor");document.getElementById(e).value="";const n=document.querySelectorAll("#"+t+" .blocks .block");removeEmptyAttributes();let o=[];for(let e=0;e<n.length;e++){const t=n[e].cloneNode(!0);t.removeAttribute("contenteditable"),t.removeAttribute("tabindex"),t.removeAttribute("id"),t.removeAttribute("class"),t.removeAttribute("data-placeholder"),t.removeAttribute("data-block");const a=t.querySelectorAll('[contenteditable="true"]');if(a.length>0)for(let e=0;e<a.length;e++)a[e].removeAttribute("contenteditable");t.querySelectorAll("*").forEach((e=>{Array.from(e.attributes).forEach((t=>{t.name.startsWith("data-")&&e.removeAttribute(t.name)}))})),cleanUpNestedTags(t),t.innerHTML=t.innerHTML.replace(/<br[^>]*>/g,""),t.innerHTML=t.innerHTML.replace(/<li[^>]*>\s*<\/li>/g,""),t.innerHTML=t.innerHTML.replace(/id="table[^"]*"/g,""),("embed"===t.tagName.toLowerCase()||"figure"===t.tagName.toLowerCase()||""!==t.textContent.trim()&&""!==t.innerHTML.trim())&&o.push(t.outerHTML)}let a=o.join("\n");a=a.replace(/<br[^>]*>/g,"").replace(/\n/g,""),a=a.replace(/[\r\n]+/g,"");let l=sanitizeHtml(a);document.getElementById(e).value=sanitizeHtml(l),a.length>0&&localStore.save(t,replaceAngleBrackets(sanitizeHtml(l)))}const cleanUpNestedTags=e=>{const t=["strong","em","b","i","br","span"];for(let n=0;n<t.length;n++){const o=t[n],a=e.getElementsByTagName(o);for(let e=a.length-1;e>=0;e--){const t=a[e];if(t.parentNode&&t.parentNode.tagName.toLowerCase()===o){for(;t.firstChild;)t.parentNode.insertBefore(t.firstChild,t);t.parentNode.removeChild(t)}}}},convertToTag=(e,t,n)=>{const o=document.getElementById(t),a=o.tagName,l=o.innerText,r=document.createElement(n);if(r.setAttribute("contenteditable","true"),r.setAttribute("tabindex","0"),r.id=t,r.setAttribute("data-placeholder","Type something..."),r.className="block","OL"===a&&"ul"===n||"UL"===a&&"ol"===n){const e=o.querySelectorAll("li");for(let t=0;t<e.length;t++){const n=e[t],o=document.createElement("li");o.innerText=n.innerText,r.appendChild(o)}}else if("ol"===n||"ul"===n){const e=document.createElement("li");e.innerText=l,r.appendChild(e)}else r.innerText=l.replace(/<br[^>]*>/g,"").replace(/[\r\n]+/g,"");"ol"!==n&&"ul"!==n&&keyboardSupport(r,e),o.replaceWith(r),inlineTool(e,t),r.focus(),document.querySelector("#MN"+t+" ."+n).disabled=!0,document.querySelector("#MN"+t+" ."+a.toLowerCase()).disabled=!1,document.querySelector("#TB"+t+" .menuOnOff").innerText=n.toUpperCase()},inlineTool=(e,t)=>{const n=document.querySelector("#"+e).querySelector("#TB"+t),o=document.getElementById(t),a=document.getElementById("TBAR"+t)||document.querySelector("#TB"+t+" .toolbar"),l=a.querySelector(".boldButton"),r=a.querySelector(".quoteButton"),c=a.querySelector(".markButton"),i=a.querySelector(".delButton"),d=a.querySelector(".italicButton"),s=a.querySelector(".underlineButton"),m=a.querySelector(".codeButton"),u=a.querySelector(".removeFormattingButton"),p=a.querySelector(".insertLink"),b=a.querySelector(".linkTarget");o.addEventListener("focus",(e=>{const t=n.querySelectorAll("a");for(let e=0;e<t.length;e++){const n=t[e];n.href&&(n.dataset.listenerAdded||(v(n),h(n),n.dataset.listenerAdded="true"))}})),l.addEventListener("click",(()=>{g("strong")})),d.addEventListener("click",(()=>{g("em")})),s.addEventListener("click",(()=>{g("u")})),r.addEventListener("click",(()=>{g("q")})),c.addEventListener("click",(()=>{g("mark")})),i.addEventListener("click",(()=>{g("del")})),m.addEventListener("click",(()=>{g("code")}));const g=e=>{const t=window.getSelection();if(t.rangeCount>0){const n=t.getRangeAt(0),o=n.extractContents(),l=o.parentNode;if("function"==typeof document.execCommand){const t=document.createElement(e);t.appendChild(o),n.insertNode(t),document.execCommand("insertHTML",!1,t.outerHTML)}else if(l&&l.nodeName.toLowerCase()===e){const e=document.createTextNode(o.textContent);n.insertNode(e),l.remove()}else{const t=document.createElement(e);t.appendChild(o),n.insertNode(t)}a.classList.remove("active")}else alert("No text selected. Please select some text to link.")};u.addEventListener("click",(()=>{const e=window.getSelection();if(e.rangeCount>0){const t=e.getRangeAt(0),n=t.extractContents(),o=document.createElement("div");o.appendChild(n);const l=o.querySelectorAll("a");for(let e=0;e<l.length;e++){const t=document.createTextNode(l[e].textContent);l[e].parentNode.replaceChild(t,l[e])}const r=document.createTextNode(o.textContent);t.deleteContents(),t.insertNode(r),a.classList.remove("active")}})),p.addEventListener("click",(()=>{const e=prompt("Enter the link URL:","https://"),t=b.value;if(e){const n=window.getSelection();if(n.rangeCount>0){const o=n.getRangeAt(0),a=n.toString(),l=document.createElement("a");l.href=e,l.target=t,l.rel="noopener",l.textContent=a,o.deleteContents(),o.insertNode(l)}}a.classList.remove("active")}));const h=e=>{b.addEventListener("change",(t=>{t.preventDefault();window.getSelection().toString()===e.textContent&&(e.target=b.value)}))},v=e=>{const t=t=>{t.preventDefault();const n=prompt("Change link URL:",e.href);if(n){e.href=n;const t=prompt("Change rel Attribute: help, nofollow, tag, privacy-policy, terms-of-service",e.rel);t&&(e.rel=t)}return!1};e.removeEventListener("click",t),e.addEventListener("click",t)}},tableOption=(e,t)=>{const n=document.getElementById("table"+e),o=n.rows.length;switch(t){case"addRow":const a=n.insertRow(-1),l=n.rows[0].cells.length;for(let t=0;t<l;t++){const n=a.insertCell(t);n.setAttribute("contenteditable","true"),n.dataset.block=e,n.innerHTML="New Row, Cell "+(t+1)}break;case"removeRow":o>1?n.deleteRow(o-1):alert("Cannot remove the header row.");break;case"addColumn":for(let t=0;t<o;t++){const o=n.rows[t].insertCell(-1);o.setAttribute("contenteditable","true"),o.dataset.block=e,o.innerHTML="New Cell "+(t+1)}break;case"removeColumn":if(n.rows[0].cells.length>1)for(let e=0;e<o;e++)n.rows[e].deleteCell(-1);else alert("Cannot remove the last column.");break;case"removeCaption":const r=n.querySelector("caption");r&&n.removeChild(r);break;case"addCaption":console.log("Add Caption");const c=document.createElement("caption");c.setAttribute("contenteditable","true"),c.setAttribute("data-placeholder","Table Caption"),c.dataset.block=e,n.appendChild(c);break;default:console.warn("Unknown option:",t)}},imageOption=(e,t)=>{const n=document.getElementById(e),o=n?.querySelector("img");if(!o)return void console.error(`Image element not found in block with ID: ${e}`);let a;switch(t){case"alt":a=prompt("Image Alt:",o.alt),a&&(o.alt=a);break;case"link":a=prompt("Image Link:",o.src),a&&(o.src=a);break;case"width":a=prompt("Image Width:",o.width),a&&(o.width=a);break;case"height":a=prompt("Image Height:",o.height),a&&(o.height=a);break;case"removeCaption":const l=n.querySelector("figcaption");l?n.removeChild(l):console.warn("No caption found to remove.");break;case"addCaption":console.log("addCaptionImage");const r=document.createElement("figcaption");r.setAttribute("contenteditable","true"),r.setAttribute("data-placeholder","Image Description"),r.dataset.block=e,n.appendChild(r);break;default:console.error("Invalid option: "+t)}},embedOption=(e,t)=>{const n=document.getElementById(e);if(!n)return void console.error(`Element with ID ${e} not found.`);let o;switch(t){case"link":o=prompt("Embed Link:",n.src),o&&(n.src=o);break;case"width":o=prompt("Embed Width:",n.width),o&&(n.width=o);break;case"height":o=prompt("Embed Height:",n.height),o&&(n.height=o);break;default:console.error("Invalid option: "+t)}};function imageUpload(e){const t=document.getElementById("form-upload");t&&t.remove();const n=document.createElement("form");n.enctype="multipart/form-data",n.id="form-upload",n.style.display="none";const o=document.createElement("input");o.type="file",o.name="file[]",o.multiple=!0,n.appendChild(o),document.body.prepend(n),o.click(),"undefined"!=typeof timer&&clearInterval(timer),timer=setInterval((function(){if(""!==o.value){clearInterval(timer);const t=new FormData(n);fetch("index.php?route=common/filemanager/upload&token=<?php echo $token; ?>&directory="+"",{method:"POST",body:t}).then((e=>e.json())).then((t=>{if(console.log("Upload: "+t.file.url),t.error&&alert(t.error),t.success){document.getElementById(e).querySelector("img").src=t.file.url}})).catch((e=>{alert(e)})).finally((()=>{}))}}),500)}function processContent(e,t){const n=document.getElementById(t).value.replace(/[\r\n]+/g," ").replace(/\s{2,}/g," ").replace(/>\s+</g,"><").replace(/<span[^>]*>(.*?)<\/span>/gi,"$1"),o=(new DOMParser).parseFromString(n,"text/html");o.querySelectorAll("span").forEach((e=>e.remove()));o.querySelectorAll("br").forEach((e=>e.remove()));const a=document.querySelector("#"+e+" .blocks");a.innerHTML="";let l=Date.now()%1e4;const r=o.body.childNodes;for(let t=0;t<r.length;t++){const n=r[t];if(n.nodeType===Node.ELEMENT_NODE){const t=n.tagName.toLowerCase();let o;if("img"===t){o=document.createElement("figure"),o.setAttribute("tabindex","0"),o.id=l,o.className="block";const e=document.createElement("picture"),t=document.createElement("img");t.src=n.src;const a=document.createElement("figcaption");a.setAttribute("data-placeholder","Image Description"),a.setAttribute("contenteditable","true"),a.dataset.block=l,e.appendChild(t),o.appendChild(e),o.appendChild(a)}else{const e=(new DOMParser).parseFromString(n.innerHTML,"text/html"),a=e.querySelector("table"),r=e.querySelectorAll("caption"),c=e.querySelectorAll("td"),i=e.querySelectorAll("figcaption");if(c.length>0)for(let e=0;e<c.length;e++)c[e].setAttribute("contenteditable","true"),c[e].dataset.block=l;if(r.length>0)for(let e=0;e<r.length;e++)r[e].setAttribute("contenteditable","true"),r[e].setAttribute("data-placeholder","Table Caption"),r[e].dataset.block=l;if(a&&(a.id="table"+l),i.length>0)for(let e=0;e<i.length;e++)i[e].setAttribute("contenteditable","true"),i[e].setAttribute("data-placeholder","Image Description"),i[e].dataset.block=l;n.innerHTML=e.body.innerHTML,o=document.createElement(t),o.innerHTML=n.innerHTML,o.setAttribute("contenteditable","true"),o.setAttribute("tabindex","0"),o.id=l,o.className="block","embed"===t&&(o.src=n.src,o.width=n.width,o.height=n.height,o.removeAttribute("contenteditable")),(n.innerHTML.includes("<table")||/<table\b[^>]*>/i.test(n.innerHTML))&&o.removeAttribute("contenteditable"),"figure"===t&&o.removeAttribute("contenteditable")}if("figure"===t||"img"===t){const e=createMenuList(l,o,"image");a.appendChild(e)}else if("embed"===t){const e=createMenuList(l,o,"embed");a.appendChild(e)}else if(n.innerHTML.includes("<table")||/<table\b[^>]*>/i.test(n.innerHTML)){const e=createMenuList(l,o,"table");a.appendChild(e)}else{const e=createMenuList(l,o,"general");a.appendChild(e)}keyboardSupport(o,e),inlineTool(e,l),l++}}}function sanitizeHtml(e){const t=document.createElement("div");t.innerHTML=e;const n=["b","i","em","strong","q","mark","del","a","p","u","ul","ol","li","h1","h2","h3","h4","h5","h6","img","table","tr","td","embed"];return function e(t){if(t.nodeType===Node.ELEMENT_NODE){if(!n.includes(t.tagName.toLowerCase()))return void t.remove();const o=[];for(let e of Array.from(t.attributes))"href"!==e.name&&"target"!==e.name&&o.push(e.name);for(let e of o)t.removeAttribute(e);for(let n of Array.from(t.childNodes))e(n)}}(t),t.innerHTML}document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelectorAll(".results");for(let t=0;t<e.length;t++){const n=e[t],o=n.getAttribute("data-editor");""!==n.value.trim()?processContent(o,n.id):addBlock(o,!1)}}));const replaceAngleBrackets=e=>e.replace(/</g,"/**").replace(/>/g,"**/"),restoreAngleBrackets=e=>e.replace(/\/\*\*/g,"<").replace(/\*\*\//g,">"),localStore={save:(e,t)=>{const n=new Date;localStorage.setItem(e,t),localStorage.setItem(e+"-date",n.toISOString())},load:(e,t)=>{const n=localStorage.getItem(e);n&&(document.getElementById("results"+e).innerHTML=n)},clear:e=>{localStorage.removeItem(e)}};
</script>
</body>
</html>
